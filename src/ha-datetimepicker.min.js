function HaDateTimePicker(e,t){this.target=e;var a=!!(t=t||{}).is24&&"true"===t.is24.toString().toLowerCase(),i=!!t.isSolar&&"true"===t.isSolar.toString().toLowerCase(),s=!!t.isLunar&&"true"===t.isLunar.toString().toLowerCase();this.dpDOM=null,this.eventHandler=document.createElement("DIV"),this.uId="hadp"+Math.floor(65536*(1+Math.random())).toString(16).substring(1)+(new Date).getSeconds();var o=!!t.timePickerOnly&&"true"===t.timePickerOnly.toString().toLowerCase();if(("string"==typeof t.selectedDate||t.selectedDate instanceof String)&&(t.selectedDate="NaN"!==Date.parse(t.selectedDate).toString()?"true"===t.resultInSolar?new HaSolarDate(t.selectedDate):new Date(t.selectedDate):null),this.options={date:t.date||new Date,is24:a,isSolar:i,isLunar:s,maxYear:t.maxYear||(!0==i?1450:!0==s?1480:2050),minYear:t.minYear||(!0==i?1350:!0==s?1380:1950),pagingDuration:t.pagingDuration||600,selectedDate:t.selectedDate||null,extraTargets:t.extraTargets||null,extraLunarTargets:t.extraLunarTargets||null,extraSolarTargets:t.extraSolarTargets||null,minAllowedDate:t.minAllowedDate||null,maxAllowedDate:t.maxAllowedDate||null,forceSetTime:!!t.forceSetTime&&"true"===t.forceSetTime.toString().toLowerCase(),resultInSolar:!!t.resultInSolar&&"true"===t.resultInSolar.toString().toLowerCase(),resultInLunar:!!t.resultInLunar&&"true"===t.resultInLunar.toString().toLowerCase(),disableTime:!!t.disableTime&&"true"===t.disableTime.toString().toLowerCase(),disableAnimations:!!t.disableAnimations&&"true"===t.disableAnimations.toString().toLowerCase(),timePickerOnly:o,disableOkButton:!!t.disableOkButton&&"true"===t.disableOkButton.toString().toLowerCase(),resultFormat:t.is24?t.resultFormat||(o?"{hour}:{minute}":"{month}/{day}/{year} {t?{hour}:{minute}}"):t.resultFormat||(o?"{hour}:{minute} {ampm}":"{month}/{day}/{year} {t?{hour}:{minute} {ampm}}"),disabledWeekDays:t.disabledWeekDays||null},this.options.timePickerOnly?this.clock=!0:this.clock=!1,this.options.disabledWeekDays){this.options.disabledWeekDays.constructor===Array&&this.options.disabledWeekDays instanceof Array&&!this||(this.options.disabledWeekDays=this.options.disabledWeekDays.split(","));for(var n=0;n<this.options.disabledWeekDays.length;n++)this.options.disabledWeekDays[n]=Number(this.options.disabledWeekDays[n].toString()),7==this.options.disabledWeekDays[n]&&this.options.disabledWeekDays.push(0)}"undefined"==typeof HaSolarDate?(this.options.isSolar=!1,this.options.resultInSolar=!1):this.solarDate=new HaSolarDate,"undefined"==typeof HaLunarDate?(this.options.isLunar=!1,this.options.resultInLunar=!1):this.lunarDate=new HaLunarDate,this.options.isSolar?window.HaDateSource=HaSolarDate:this.options.isLunar?window.HaDateSource=HaLunarDate:window.HaDateSource=Date,null!=this.options.selectedDate&&(this.options.is24?this.selectedTime={hour:this.options.selectedDate.getHours(),minute:this.options.selectedDate.getMinutes(),amOrPm:12<=this.options.selectedDate.getHours()?"pm":"am"}:this.selectedTime={hour:12<=this.options.selectedDate.getHours()?this.options.selectedDate.getHours()-12:this.options.selectedDate.getHours(),minute:this.options.selectedDate.getMinutes(),amOrPm:12<=this.options.selectedDate.getHours()?"pm":"am"}),!0===this.options.isLunar?(this.days=this.lunarDate.dayNames,this.monthNames=this.lunarDate.monthNames,this.renderedDate=this.lunarDate.convertFromGregorian(this.options.date),null!=this.options.selectedDate&&(this.selectedDate=!1===this.options.resultInLunar?this.lunarDate.convertFromGregorian(this.options.selectedDate):new HaLunarDate(this.options.selectedDate.getFullYear(),this.options.selectedDate.getMonth(),this.options.selectedDate.getDate()))):!0===this.options.isSolar?(this.days=this.solarDate.dayNames,this.monthNames=this.solarDate.monthNames,this.renderedDate=this.solarDate.convertFromGregorian(this.options.date),null!=this.options.selectedDate&&(this.selectedDate=!1===this.options.resultInSolar?this.solarDate.convertFromGregorian(this.options.selectedDate):new HaSolarDate(this.options.selectedDate.getFullYear(),this.options.selectedDate.getMonth(),this.options.selectedDate.getDate()))):(this.renderedDate=this.options.date,null!=this.options.selectedDate&&(this.selectedDate=!1===this.options.resultInSolar?this.options.selectedDate:this.solarDate.convertToGregorian(new HaSolarDate(this.options.selectedDate.getFullYear(),this.options.selectedDate.getMonth(),this.options.selectedDate.getDate()))),this.days=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"]),this.options.maxAllowedDate&&(this.options.maxAllowedDate=this.options.isSolar?new HaSolarDate(this.options.maxAllowedDate):this.options.isLunar?new HaLunarDate(this.options.maxAllowedDate):new Date(this.options.maxAllowedDate),this.options.maxYear=Math.min(this.options.maxYear,this.options.maxAllowedDate.getFullYear()),0<this.options.date.compare(this.options.maxAllowedDate,this.renderedDate)&&(this.renderedDate=this.options.maxAllowedDate)),this.options.minAllowedDate&&(this.options.minAllowedDate=this.options.isSolar?new HaSolarDate(this.options.minAllowedDate):this.options.isLunar?new HaLunarDate(this.options.minAllowedDate):new Date(this.options.minAllowedDate),this.options.minYear=Math.max(this.options.minYear,this.options.minAllowedDate.getFullYear()),this.options.date.compare(this.options.minAllowedDate,this.options.renderedDate)<0&&(this.renderedDate=this.options.minAllowedDate)),!0===this.options.disableTime&&(this.options.forceSetTime=!1,this.selectedTime=null)}HaDateTimePicker.prototype.init=function(){0<document.querySelectorAll(".ha-datetimepicker").length&&document.body.removeChild(document.querySelector(".ha-datetimepicker")),this.options.isSolar?window.HaDateSource=HaSolarDate:this.options.isLunar?window.HaDateSource=HaLunarDate:window.HaDateSource=Date,String.prototype.toLocalDigit=this.options.isSolar?function(){return this.replace(/\d+/g,function(e){for(var t="",a=0;a<e.length;a++)t+=String.fromCharCode(e.charCodeAt(a)+1728);return t})}:function(){return this.replace(/\d+/g,function(e){for(var t="",a=0;a<e.length;a++)t+=String.fromCharCode(e.charCodeAt(a)+1584);return t})},this.createCalendar(),this.setupStyles(),this.createEvents(),this.renderDate(this.selectedDate||this.renderedDate),this.renderClock(),null!=this.selectedTime&&(this.renderHourHand(),this.renderMinuteHand()),this.addEvents(),this.renderResult()},HaDateTimePicker.prototype.createCalendar=function(){var e=this.options.isSolar||this.options.isLunar?this.renderedDate.getFullYear().toString().toLocalDigit():this.renderedDate.getFullYear(),t=this.options.timePickerOnly?"clock timePickerOnly":"",a=this.options.disableAnimations?"no-anim":"";this.options.disableAnimations&&(this.options.pagingDuration=0);var i="<div class='ha-datetimepicker "+a+" "+t+" "+(this.options.isSolar?"fa":this.options.isLunar?"ar":"en")+"' id='"+this.uId+"'><div class='ha-dp-dim'></div><div class='ha-datetimepicker-container'>";i+="<div class='ha-dp-header'><div class='ha-dp-year'><div class='ha-dp-year-dropdown-container'><button type='button' class='ha-dp-year-btn'>"+e+"</button><ul class='ha-dp-year-dropdown'>";for(var s=this.options.minYear;s<=this.options.maxYear;s++){s%10==0&&(i+="<hr class='ha-dp-list-separator'/>");var o=this.options.isSolar||this.options.isLunar?s.toString().toLocalDigit():s;i+="<li class='ha-dp-year-item' data-year='"+s+"'>"+o+"</li>"}i+="</ul></div></div><div class='ha-dp-month'><button type='button' class='ha-dp-prev-btn'><</button><div class='ha-dp-month-dropdown-container'><button type='button' class='ha-dp-month-btn'>"+this.monthNames[this.renderedDate.getMonth()]+"</button><ul class='ha-dp-month-dropdown'>";for(var n=0;n<this.monthNames.length;n++)i+="<li class='ha-dp-month-item'>"+this.monthNames[n]+"</li>";i+="</ul></div><button type='button' class='ha-dp-next-btn'>></button></div></div>",i+="<div class='ha-dp-body'>",i+="<div>";for(var r=0;r<7;r++){i+="<p class='ha-dp-cell ha-dp-cell-header'>"+(this.options.isSolar?this.days[r][0]:this.days[r])}if(i+="</div>",i+="<div class='ha-dp-days-container'></div>",i+="</div>",!1===this.options.disableTime){var l="";this.options.is24&&(l=" ds-none "),i+="<div class='ha-dp-clock'><div class='ha-dp-clock-header'><div class='ha-dp-ampm"+l+"'><div type='button' class='ha-dp-clock-am-btn"+(this.selectedTime&&"am"==this.selectedTime.amOrPm.toLowerCase()||!this.selectedTime?" selected":"")+"'>AM</div><button type='button' class='ha-dp-clock-ampm-btn"+(this.selectedTime&&"pm"==this.selectedTime.amOrPm.toLowerCase()?" pm":" am")+"'>AMPM</button><div type='button' class='ha-dp-clock-pm-btn"+(this.selectedTime&&"pm"==this.selectedTime.amOrPm.toLowerCase()?" selected":"")+"'>PM</div></div></div><div class='ha-dp-clock-body'><div class='ha-dp-clock-face'><div class='hours-clock-face'></div></div></div><div class='ha-dp-clock-footer'><p class='ha-dp-clock-res'></p>",this.options.disableOkButton||(i+="<button type='button' class='ha-dp-btn ha-dp-clock-ok-btn'>OK</button>"),i+="</div></div>"}i+="<div class='ha-dp-footer'><p class='ha-dp-result'>-</p>",this.options.disableOkButton||(i+="<div class='ha-dp-buttons'><button type='button' class='ha-dp-btn ha-dp-cancel-btn'>Cancel</button><button type='button' class='ha-dp-btn ha-dp-ok-btn'>OK</button>",!1===this.options.disableTime&&(i+="<button type='button' class='ha-dp-btn ha-dp-clock-btn'>Clock</button>"),i+="</div>"),i+="</div>";var d=createFragment(i+="</div></div>");this.dpDOM=d,document.body.insertBefore(d,document.body.childNodes[document.body.childNodes.length-1])},HaDateTimePicker.prototype.setupStyles=function(){document.querySelector(".ha-dp-days-container").setAttribute("style","animation-duration:"+this.options.pagingDuration+"ms"),(this.options.isSolar||this.options.isLunar)&&(document.querySelector(".ha-dp-body").style.direction="rtl")},HaDateTimePicker.prototype.renderDate=function(e){this.renderedDate=new HaDateSource(e),this.renderedDate.setDate(1);for(var t,a,i=[{daysOfWeek:[]}],s=document.querySelector(".ha-datetimepicker"),o=0;o<s.classList.length;o++)0<=s.classList[o].indexOf("month")&&s.classList.remove(s.classList[o]);s.className+=" month"+e.getMonth(),a=new HaDateSource(e.getFullYear(),e.getMonth(),1),t=new HaDateSource;o=1-a.getDay();for(var n=1;n<=6;n++){for(var r=new Array,l=1;l<=7;l++)r.push(o++);i.push({daysOfWeek:r})}document.querySelector(".ha-dp-year-btn").innerHTML=this.options.isSolar||this.options.isLunar?e.getFullYear().toString().toLocalDigit():e.getFullYear();for(var d=document.getElementsByClassName("ha-dp-year-item"),c=0;c<d.length;c++)d[c].classList.contains("selected")&&d[c].classList.remove("selected");var h=document.querySelector(".ha-dp-year-item[data-year='"+e.getFullYear()+"']");null!=h&&(h.className+=" selected"),document.querySelector(".ha-dp-month-btn").innerHTML=this.monthNames[e.getMonth()];var u=document.querySelector(".ha-dp-days-container"),m=new HaDateSource,p=m.getMonthTotalDays(e.getMonth(),e.getFullYear()),g=m.getMonthTotalDays(e.getMonth()-1,e.getFullYear());delete m;for(var D="",v=0;v<i.length;v++){for(var y="<div>",f=0;f<i[v].daysOfWeek.length;f++){var b=i[v].daysOfWeek[f];if(b<=p&&0<b){var k=null!=this.selectedDate&&this.selectedDate.getFullYear()==e.getFullYear()&&this.selectedDate.getMonth()==e.getMonth()&&this.selectedDate.getDate()==b?" ha-dp-cell-selected":"",w="";if(null!=this.options.minAllowedDate&&(w=0<this.options.date.compare(new Date(e.getFullYear(),e.getMonth(),b),this.options.minAllowedDate)?" ha-dp-cell-muted":w),null!=this.options.maxAllowedDate&&(w=this.options.date.compare(new Date(e.getFullYear(),e.getMonth(),b),this.options.maxAllowedDate)<0?" ha-dp-cell-muted":w),null!=this.options.disabledWeekDays){var S=this.options.isSolar||this.options.isLunar?f:f+1;0<=this.options.disabledWeekDays.indexOf(S)&&(w=" ha-dp-cell-muted")}var T,H=t.getFullYear()==e.getFullYear()&&t.getMonth()==e.getMonth()&&t.getDate()==b?" ha-dp-cell-currentdate":"";T=this.options.isSolar||this.options.isLunar?6==f?" ha-dp-cell-holiday":"":5==f?" ha-dp-cell-holiday":"";var L=1==this.options.isSolar||this.options.isLunar?b.toString().toLocalDigit():b;y+="<p class='ha-dp-cell"+T+H+k+w+"' data-date='"+b+"' data-disp='"+L+"'>"+L+"</p>"}else if(b<1){y+="<p class='ha-dp-cell ha-dp-cell-muted' data-date='"+(g+b)+"'>"+(L=1==this.options.isSolar||this.options.isLunar?(g+b).toString().toLocalDigit():g+b)+"</p>"}else{y+="<p class='ha-dp-cell ha-dp-cell-muted' data-date='"+(b-p)+"'>"+(L=1==this.options.isSolar||this.options.isLunar?(b-p).toString().toLocalDigit():b-p)+"</p>"}}D+=y+="</div>"}u.innerHTML=D,this.addEvents(),this.events.pageChanged.detail.isClock=self.clock,this.eventHandler.dispatchEvent(this.events.pageChanged)},HaDateTimePicker.prototype.changeDate=function(e){var t=document.querySelector(".ha-dp-days-container"),a=this.options.pagingDuration;t.className=t.className.replace("page-left","").replace("page-right","").trim(),-1==this.options.date.compare(e,this.renderedDate)?t.className+=" page-left":t.className+=" page-right";var i=this;setTimeout(function(){i.renderDate(new HaDateSource(e.getFullYear(),e.getMonth(),e.getDate()))},a/2),setTimeout(function(){t.className=t.className.replace("page-left","").replace("page-right","").trim()},a)},HaDateTimePicker.prototype.createEvents=function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var a=document.createEvent("CustomEvent");return a.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),a}e.prototype=window.Event.prototype,window.CustomEvent=e,this.events={selectedDateChanged:new CustomEvent("selectedDateChanged",{detail:{selectedDate:this.getResult()}}),selectedTimeChanged:new CustomEvent("selectedTimeChanged",{detail:{selectedTime:this.selectedTime}}),pageChanged:new CustomEvent("pageChanged",{detail:{date:this.renderedDate}}),clockToggled:new CustomEvent("clockToggled",{detail:{isClock:this.clock}}),pickerShow:new CustomEvent("pickerShow"),pickerHide:new CustomEvent("pickerHide")}},HaDateTimePicker.prototype.addEventListener=function(e,t){this.eventHandler.addEventListener(e,t)},HaDateTimePicker.prototype.addEvents=function(){document.querySelector(".ha-dp-days-container");for(var i=new Date,s=this,t=document.querySelectorAll("#"+this.uId+" .ha-dp-cell:not(.ha-dp-cell-muted):not(.ha-dp-cell-header)"),e=0;e<t.length;e++)t[e].onclick=function(){for(var e=0;e<t.length;e++)t[e].className=t[e].className.replace("ha-dp-cell-selected","").trim();this.className+=" ha-dp-cell-selected",s.selectedDate=new HaDateSource(s.renderedDate.getFullYear(),s.renderedDate.getMonth(),parseInt(this.getAttribute("data-date"))),s.events.selectedDateChanged.detail.selectedDate=s.selectedDate,s.eventHandler.dispatchEvent(s.events.selectedDateChanged),s.renderResult(),s.options.disableOkButton&&(s.toggleClock(),s.returnResults())};document.querySelector(".ha-dp-dim").onclick=function(){s.hide()};var a=document.querySelector(".ha-dp-next-btn"),o=document.querySelector(".ha-dp-prev-btn");a.onclick=function(){var e=s.renderedDate.getFullYear(),t=s.renderedDate.getMonth()+1;12<=t&&(e++,t=0);var a=new HaDateSource(e,t,i.getDate());s.changeDate(a)},o.onclick=function(){var e=s.renderedDate.getFullYear(),t=s.renderedDate.getMonth()-1;t<0&&(e--,t=11),s.changeDate(new HaDateSource(e,t,i.getDate()))};var n=document.querySelector(".ha-dp-month-btn"),r=document.querySelector(".ha-dp-year-btn"),l=document.querySelector(".ha-dp-month-dropdown"),d=document.querySelector(".ha-dp-year-dropdown");document.querySelector("body").addEventListener("click",function(){-1<l.className.indexOf("show")&&(l.className=l.className.replace("show","").trim()),-1<d.className.indexOf("show")&&(d.className=d.className.replace("show","").trim())}),n.onclick=function(e){e.stopPropagation(),-1<d.className.indexOf("show")&&(d.className=d.className.replace("show","").trim()),-1<l.className.indexOf("show")?l.className=l.className.replace("show","").trim():l.className+=" show"},r.onclick=function(e){e.stopPropagation(),-1<l.className.indexOf("show")&&(l.className=l.className.replace("show","").trim()),-1<d.className.indexOf("show")?d.className=d.className.replace("show","").trim():d.className+=" show";var t=document.querySelector(".ha-dp-year-item.selected");if(null!=t){var a=Math.max(t.getAttribute("data-year")-5,document.querySelector(".ha-dp-year-item").getAttribute("data-year"));(t=document.querySelector(".ha-dp-year-item[data-year='"+a+"']")).scrollIntoView()}};for(var c=document.querySelectorAll(".ha-dp-month-item"),h=0;h<c.length;h++)c[h].index=h,c[h].onclick=function(){if(this.index!=s.renderedDate.getMonth()){var e=this.index;s.changeDate(new Date(s.renderedDate.getFullYear(),e,i.getDate()))}};for(var u=document.querySelectorAll(".ha-dp-year-item"),m=0;m<u.length;m++)u[m].onclick=function(){var e=this.getAttribute("data-year");e!=s.renderedDate.getFullYear()&&s.changeDate(new Date(e,s.renderedDate.getMonth(),i.getDate()))};this.options.disableOkButton||(document.querySelector(".ha-dp-ok-btn").onclick=function(){null!=s.returnResults()&&s.hide()},document.querySelector(".ha-dp-cancel-btn").onclick=function(){s.hide()});if(!1===this.options.disableTime){if(!this.options.disableOkButton)document.querySelector(".ha-dp-clock-btn").onclick=function(){s.toggleClock()};var p=document.querySelector(".ha-dp-clock-am-btn"),g=document.querySelector(".ha-dp-clock-pm-btn");if(p.onclick=function(){s.changeAmPm("am")},g.onclick=function(){s.changeAmPm("pm")},document.querySelector(".ha-dp-clock-ampm-btn").onclick=function(){s.changeAmPm()},!this.options.disableOkButton)document.querySelector(".ha-dp-clock-ok-btn").onclick=function(){s.options.timePickerOnly?s.returnResults()&&s.hide():s.toggleClock()};var D=!1,v=document.querySelector(".hours-clock-face");v.addEventListener("mouseenter",function(){D=!0}),v.addEventListener("mouseleave",function(){D=!1}),v.onwheel=function(e){if(e.preventDefault(),e.stopPropagation(),null!=s.selectedTime){var t=Number(s.selectedTime.hour);e.wheelDelta<0||0<e.detail?s.setTime({hour:t-1}):s.setTime({hour:t+1})}},document.querySelector(".ha-dp-clock-face").onwheel=function(e){if(e.preventDefault(),e.stopPropagation(),null!=s.selectedTime&&!D){var t=Number(s.selectedTime.minute);e.wheelDelta<0||0<e.detail?s.setTime({minute:t-1}):s.setTime({minute:t+1})}};for(var y=document.querySelectorAll(".ha-dp-clock-num.ha-dp-hour-num .num"),f=0;f<y.length;f++)y[f].onclick=function(){var e=this.getAttribute("data-hour");s.setTime({hour:e})};var b=document.querySelectorAll(".ha-dp-clock-num.ha-dp-minute-num .num");for(f=0;f<b.length;f++)b[f].onclick=function(){var e=this.getAttribute("data-minute");s.setTime({minute:e})}}},HaDateTimePicker.prototype.setTime=function(e){this.selectedTime||(this.selectedTime={hour:0,minute:0,amOrPm:"AM"}),this.options.is24?(23<e.hour&&(e.hour=0),e.hour<0&&(e.hour=23)):(11<e.hour&&(e.hour=0),e.hour<0&&(e.hour=11)),59<e.minute&&(e.minute=0),e.minute<0&&(e.minute=59),this.selectedTime.hour=null!=e.hour?e.hour:this.selectedTime.hour,this.selectedTime.minute=null!=e.minute?e.minute:this.selectedTime.minute,this.selectedTime.amOrPm=null!=e.amOrPm?e.amOrPm:this.selectedTime.amOrPm,this.renderMinuteHand(),this.renderHourHand(),this.events.selectedTimeChanged.detail.selectedTime=this.selectedTime,this.eventHandler.dispatchEvent(this.events.selectedTimeChanged)},HaDateTimePicker.prototype.toggleClock=function(){if(!0!==this.options.disableTime){var e=document.querySelector(".ha-datetimepicker");this.clock?e.className=e.className.replace("clock","").trim():e.className+=" clock",this.clock=!this.clock,this.events.clockToggled.detail.isClock=this.clock,this.eventHandler.dispatchEvent(this.events.clockToggled),this.renderResult()}},HaDateTimePicker.prototype.renderResult=function(){var e=document.querySelector(".ha-dp-result"),t="";null!=this.selectedDate&&(t=this.options.isSolar||this.options.isLunar?this.selectedDate.getFullYear()+"/"+(this.selectedDate.getMonth()+1)+"/"+this.selectedDate.getDate():this.selectedDate.getMonth()+1+"/"+this.selectedDate.getDate()+"/"+this.selectedDate.getFullYear()),null!=this.selectedTime&&(this.options.is24?t+="   "+twoDigits(this.getHours())+":"+twoDigits(this.getMinutes()):t+="   "+twoDigits(this.getHours())+":"+twoDigits(this.getMinutes())+" "+this.getAmOrPm().toUpperCase()),e.innerHTML=""==t?"-":this.options.isSolar||this.options.isLunar?t.toLocalDigit():t},HaDateTimePicker.prototype.renderHourHand=function(){if(!0!==this.options.disableTime){for(var e,t=this.selectedTime.hour,a=document.querySelector(".hours-clock-face"),i=document.querySelector(".ha-dp-clock-hour-hand"),s=document.querySelectorAll(".ha-dp-clock-num.ha-dp-hour-num .num.selected"),o=0;o<s.length;o++)s[o].classList.remove("selected");if(document.querySelector(".ha-datetimepicker [data-hour='"+this.selectedTime.hour+"']").className+=" selected",(e=null!=i?i:document.createElement("div")).className="ha-dp-clock-hour-hand",this.options.is24)var n=180+15*t;else n=180+30*t+.5*this.selectedTime.minute;e.setAttribute("style","-webkit-transform: rotateZ("+n+"deg);-moz-transform: rotateZ("+n+"deg);transform: rotateZ("+n+"deg);"),null==i&&a.appendChild(e),this.renderClockResult()}},HaDateTimePicker.prototype.renderMinuteHand=function(){if(!0!==this.options.disableTime){for(var e=this.selectedTime.minute,t=document.querySelectorAll(".ha-dp-clock-num.ha-dp-minute-num .num.selected"),a=0;a<t.length;a++)t[a].classList.remove("selected");document.querySelector(".ha-datetimepicker [data-minute='"+this.selectedTime.minute+"']").className+=" selected";var i,s=document.querySelector(".ha-dp-clock-face"),o=document.querySelector(".ha-dp-clock-minute-hand");(i=null!=o?o:document.createElement("div")).className="ha-dp-clock-minute-hand";var n=180+6*e;i.setAttribute("style","-webkit-transform: rotateZ("+n+"deg);-moz-transform: rotateZ("+n+"deg);transform: rotateZ("+n+"deg);"),null==o&&s.appendChild(i),this.renderClockResult()}},HaDateTimePicker.prototype.renderClockResult=function(){if(!0!==this.options.disableTime){var e=document.querySelector(".ha-dp-clock-res");this.options.is24?e.innerHTML=twoDigits(this.getHours())+":"+twoDigits(this.getMinutes()):e.innerHTML=twoDigits(this.getHours())+":"+twoDigits(this.getMinutes())+" "+this.getAmOrPm().toUpperCase(),this.options.disableOkButton&&this.returnResults()}},HaDateTimePicker.prototype.changeAmPm=function(e){if(!0!==this.options.disableTime&&null!=this.selectedTime){var t=document.querySelector(".ha-dp-clock-ampm-btn"),a=document.querySelector(".ha-dp-clock-am-btn"),i=document.querySelector(".ha-dp-clock-pm-btn");(null==e||"am"!=e.toLowerCase()&&"pm"!=e.toLowerCase())&&(e=null==this.selectedTime?"am":"am"===this.selectedTime.amOrPm.toLowerCase()?"pm":"am"),"am"==(this.selectedTime.amOrPm=e).toLowerCase()?(i.classList.remove("selected"),a.classList.add("selected")):(a.classList.remove("selected"),i.classList.add("selected")),t.classList.remove("am"),t.classList.remove("pm"),t.classList.add(e),this.renderClockResult(),this.events.selectedTimeChanged.detail.selectedTime=this.selectedTime,this.eventHandler.dispatchEvent(this.events.selectedTimeChanged)}},HaDateTimePicker.prototype.getHours=function(){var e=this.selectedTime.hour;return this.options.is24?24==this.selectedTime.hour&&(e=0):"pm"==this.selectedTime.amOrPm.toLowerCase()&&0==e&&(e=12),e},HaDateTimePicker.prototype.getMinutes=function(){return this.selectedTime.minute},HaDateTimePicker.prototype.getAmOrPm=function(){return this.selectedTime.amOrPm},HaDateTimePicker.prototype.renderClock=function(){if(!0!==this.options.disableTime){var e=document.querySelector(".ha-dp-clock-face"),t=document.querySelector(".hours-clock-face");if(this.options.is24)for(var a=0;a<24;a++){(o=document.createElement("div")).className="ha-dp-clock-num ha-dp-hour-num",(n=document.createElement("span")).setAttribute("data-hour",a),n.className="num",n.innerHTML=0==a?0:a,o.appendChild(n);var i=180+15*a;o.setAttribute("style","-webkit-transform: rotateZ("+i+"deg);-moz-transform: rotateZ("+i+"deg);transform: rotateZ("+i+"deg);"),n.setAttribute("style","-webkit-transform: rotateZ("+-i+"deg);-moz-transform: rotateZ("+-i+"deg);transform: rotateZ("+-i+"deg);"),e.appendChild(o)}else for(a=0;a<12;a++){(o=document.createElement("div")).className="ha-dp-clock-num ha-dp-hour-num",(n=document.createElement("span")).setAttribute("data-hour",a),n.className="num",n.innerHTML=0==a?12:a,o.appendChild(n);i=180+30*a;o.setAttribute("style","-webkit-transform: rotateZ("+i+"deg);-moz-transform: rotateZ("+i+"deg);transform: rotateZ("+i+"deg);"),n.setAttribute("style","-webkit-transform: rotateZ("+-i+"deg);-moz-transform: rotateZ("+-i+"deg);transform: rotateZ("+-i+"deg);"),t.appendChild(o)}for(var s=0;s<60;s++){var o,n;(o=document.createElement("div")).className="ha-dp-clock-num ha-dp-minute-num",(n=document.createElement("span")).setAttribute("data-minute",s),n.className="num",n.innerHTML=s%5==0?0==s||5==s?"0"+s:s:"â€¢",n.className+=s%5!=0?" dot":"",o.appendChild(n);i=180+6*s;o.setAttribute("style","-webkit-transform: rotateZ("+i+"deg);-moz-transform: rotateZ("+i+"deg);transform: rotateZ("+i+"deg);"),n.setAttribute("style","-webkit-transform: rotateZ("+-i+"deg);-moz-transform: rotateZ("+-i+"deg);transform: rotateZ("+-i+"deg);"),this.options.is24?t.appendChild(o):e.appendChild(o)}}},HaDateTimePicker.prototype.returnResults=function(){if(!this.options.timePickerOnly&&null==this.selectedDate||this.options.timePickerOnly&&null==this.selectedTime)return null;if(this.options.forceSetTime&&!this.selectedTime)return this.toggleClock(),null;for(var e=this.target.nodeType?[this.target]:document.querySelectorAll(this.target),t=this.getFormatedResult(),a=0;a<e.length;a++){var i=e[a];"input"==i.tagName.toLowerCase()?i.value=t:i.innerHTML=t}if(this.options.extraTargets)for(var s=document.querySelectorAll(this.options.extraTargets),o=this.getResult("gregorian"),n=this.getExtraTargetsResultString(o),r=0;r<s.length;r++)"input"==s[r].tagName.toLowerCase()?s[r].value=n:s[r].innerHTML=n;if(this.options.extraLunarTargets)for(var l=document.querySelectorAll(this.options.extraLunarTargets),d=this.getResult("lunar"),c=this.getExtraTargetsResultString(d),h=0;h<l.length;h++)"input"==l[h].tagName.toLowerCase()?l[h].value=c:l[h].innerHTML=c;if(this.options.extraSolarTargets)for(var u=document.querySelectorAll(this.options.extraSolarTargets),m=this.getResult("solar"),p=this.getExtraTargetsResultString(m),g=0;g<u.length;g++)"input"==u[g].tagName.toLowerCase()?u[g].value=p:u[g].innerHTML=p;return t},HaDateTimePicker.prototype.getExtraTargetsResultString=function(e){var t="";return this.options.timePickerOnly||(t+=e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear()),null==this.selectedTime||this.options.disableTime||(t+=" "+twoDigits(e.getHours())+":"+twoDigits(e.getMinutes())+" "+this.selectedTime.amOrPm),this.options.is24&&(t=e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear(),t+=" "+twoDigits(e.getHours())+":"+twoDigits(e.getMinutes())),t.trim()},HaDateTimePicker.prototype.getResult=function(e){var t=this.options.timePickerOnly?new Date:this.selectedDate,a=new HaDateSource;if((this.options.isSolar||this.options.isLunar)&&(t=a.convertToGregorian(this.selectedDate)),null!=e){if("solar"==e.toLowerCase())t=(new HaSolarDate).convertFromGregorian(t);else if("lunar"==e.toLowerCase()){t=(new HaLunarDate).convertFromGregorian(t),0}}else if(this.options.resultInSolar||this.options.resultInLunar){t=(this.options.resultInSolar?this.solarDate:this.lunarDate).convertFromGregorian(t)}return delete a,null!=this.selectedTime&&(t.setHours(this.getHours()),t.setMinutes(this.getMinutes())),t},HaDateTimePicker.prototype.getFormatedResult=function(){var e=this.getResult(),t=this.options.resultFormat;this.options.timePickerOnly&&(t=t.replace("{month}","").replace("{day}","").replace("{year}",""));do{var a=t.indexOf("{t?"),i=t.indexOfClosingSymbol(a,"{","}"),s="";0<=a&&(s=t.substr(a,i-a+1),t=null==this.selectedTime?t.replace(s,""):t.removeCharsAt(i).removeCharsAt(a,3))}while(0<=a);do{var o=t.indexOf("{month}")<0&&t.indexOf("{year}")<0&&t.indexOf("{day}")<0;t=t.replace("{month}",e.getMonth()+1).replace("{day}",e.getDate()).replace("{year}",e.getFullYear())}while(!o);do{var n=t.indexOf("{minute}")<0&&t.indexOf("{hour}")<0&&t.indexOf("{ampm}")<0;if(this.options.is24)n=t.indexOf("{minute}")<0&&t.indexOf("{hour}")<0;t=null!=this.selectedTime?this.options.is24?t.replace("{hour}",twoDigits(this.getHours())).replace("{minute}",twoDigits(this.getMinutes())).replace("{ampm}",""):t.replace("{hour}",twoDigits(this.getHours())).replace("{minute}",twoDigits(this.getMinutes())).replace("{ampm}",this.getAmOrPm().toUpperCase()):this.options.is24?t.replace("{hour}","").replace("{minute}",""):t.replace("{hour}","").replace("{minute}","").replace("{ampm}","")}while(!n);return t.trim()},HaDateTimePicker.prototype.show=function(){this.init();var e=this;setTimeout(function(){document.querySelector(".ha-datetimepicker").className+=" show",e.eventHandler.dispatchEvent(e.events.pickerShow)},10)},HaDateTimePicker.prototype.hide=function(){var e=document.querySelector(".ha-datetimepicker");e.className=e.className.replace("show","").trim(),this.clock=!1,this.eventHandler.dispatchEvent(this.events.pickerHide)};var dps=[];function caseInsensitiveGetAttribute(e,t){for(var a=0;a<e.attributes.length;a++){var i=e.attributes[a];if(t.toLowerCase()===i.name)return i.value}}function twoDigits(e){return e.toString().length<2&&(e="0"+e.toString()),e}function createFragment(e){var t=document.createDocumentFragment(),a=document.createElement("div");for(a.innerHTML=e;a.firstChild;)t.appendChild(a.firstChild);return t}HaDateTimePicker.init=function(){for(var e=document.querySelectorAll("[data-ha-datetimepicker]"),t=0;t<e.length;t++){e[t].addEventListener("mousedown",function(){this.blur()}),e[t].addEventListener("keydown",function(e){return e.preventDefault(),!1});var a=caseInsensitiveGetAttribute(e[t],"data-ha-dp-is24"),i=caseInsensitiveGetAttribute(e[t],"data-ha-dp-issolar"),s=caseInsensitiveGetAttribute(e[t],"data-ha-dp-islunar"),o=caseInsensitiveGetAttribute(e[t],"data-ha-dp-resultinsolar"),n=caseInsensitiveGetAttribute(e[t],"data-ha-dp-resultinlunar"),r=new HaDateTimePicker(caseInsensitiveGetAttribute(e[t],"data-ha-datetimepicker"),{date:caseInsensitiveGetAttribute(e[t],"data-ha-dp-date"),selectedDate:e[t].value?e[t].value:e[t].innerHTML?e[t].innerHTML:caseInsensitiveGetAttribute(e[t],"data-ha-dp-selecteddate"),minAllowedDate:caseInsensitiveGetAttribute(e[t],"data-ha-dp-minalloweddate"),maxAllowedDate:caseInsensitiveGetAttribute(e[t],"data-ha-dp-maxalloweddate"),pagingDuration:caseInsensitiveGetAttribute(e[t],"data-ha-dp-pagingduration"),minYear:caseInsensitiveGetAttribute(e[t],"data-ha-dp-minyear"),maxYear:caseInsensitiveGetAttribute(e[t],"data-ha-dp-maxyear"),resultInSolar:o,resultInLunar:n,is24:a,isSolar:i,isLunar:s,extraTargets:caseInsensitiveGetAttribute(e[t],"data-ha-dp-extratargets"),extraSolarTargets:caseInsensitiveGetAttribute(e[t],"data-ha-dp-extrasolartargets"),extraLunarTargets:caseInsensitiveGetAttribute(e[t],"data-ha-dp-extralunartargets"),forceSetTime:caseInsensitiveGetAttribute(e[t],"data-ha-dp-forcesettime"),disableTime:caseInsensitiveGetAttribute(e[t],"data-ha-dp-disabletime"),timePickerOnly:caseInsensitiveGetAttribute(e[t],"data-ha-dp-timepickeronly"),resultFormat:caseInsensitiveGetAttribute(e[t],"data-ha-dp-resultformat"),disabledWeekDays:caseInsensitiveGetAttribute(e[t],"data-ha-dp-disabledweekdays"),disableOkButton:caseInsensitiveGetAttribute(e[t],"data-ha-dp-disableokbutton"),disableAnimations:caseInsensitiveGetAttribute(e[t],"data-ha-dp-disableanimations")});dps.push(r),e[t].index=t,e[t].addEventListener("click",function(e){this.blur(),dps[this.index].show()})}},String.prototype.indexOfAfter=function(e,t){return preIndex=this.indexOf(e),preIndex+this.substring(preIndex).indexOf(t)},String.prototype.removeCharsAt=function(e,t){return t=t||1,this.slice(0,e)+this.slice(e+t)},String.prototype.indexOfClosingSymbol=function(e,t,a){t=t||"{",a=a||"}";for(var i=0,s=e;s<this.length;s++)if(this[s]==t&&i++,this[s]==a&&i--,i<=0)return s;return-1},Date.prototype.getMonthTotalDays=function(e,t){new Date;return 11<e+1&&t++,new Date(t,e+1,0).getDate()},Date.prototype.compare=function(e,t){return null==e?0:(null==t&&(t=e,e=this),e.getFullYear()>t.getFullYear()?-1:e.getFullYear()<t.getFullYear()?1:e.getMonth()>t.getMonth()?-1:e.getMonth()<t.getMonth()?1:e.getDate()>t.getDate()?-1:e.getDate()<t.getDate()?1:0)},HaDateTimePicker.init();